<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Deep Autoencoder Neural Networks for Maximal Christmas Decoration Enjoyment - Uncertainty...Minimized</title>
  <meta property="og:title" content="Deep Autoencoder Neural Networks for Maximal Christmas Decoration Enjoyment" />
  <meta name="twitter:title" content="Deep Autoencoder Neural Networks for Maximal Christmas Decoration …" />
  <meta name="description" content="My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around trying to find the best christmas lights. Inevitably, their are a few houses with lights that blink with the music, something I&rsquo;ve always been fascinating with.
Two years ago I embarked on a mission to build my own Christmas Tree Light Show.">
  <meta property="og:description" content="My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around trying to find the best christmas lights. Inevitably, their are a few houses with lights that blink with the music, something I&rsquo;ve always been fascinating with.
Two years ago I embarked on a mission to build my own Christmas Tree Light Show.">
  <meta name="twitter:description" content="My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around …">
  <meta name="author" content="Michael C Johnson"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Uncertainty...Minimized",
    
    "url": "/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "/post/deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment/",
          "name": "Deep autoencoder neural networks for maximal christmas decoration enjoyment"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Michael C Johnson"
  },
  "headline": "Deep Autoencoder Neural Networks for Maximal Christmas Decoration Enjoyment",
  "description" : "My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around trying to find the best christmas lights. Inevitably, their are a few houses with lights that blink with the music, something I&amp;rsquo;ve always been fascinating with.
Two years ago I embarked on a mission to build my own Christmas Tree Light Show.",
  "inLanguage" : "en",
  "wordCount": 1286,
  "datePublished" : "2018-11-21T00:00:00",
  "dateModified" : "2018-11-21T00:00:00",
  "image" : "/img/headShot2.jpg",
  "keywords" : [ "Deep Learning, Raspberry Pi, python, Keras, tensorflow" ],
  "mainEntityOfPage" : "/post/deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment/",
  "publisher" : {
    "@type": "Organization",
    "name" : "/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "/img/headShot2.jpg",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Deep Autoencoder Neural Networks for Maximal Christmas Decoration Enjoyment" />
<meta property="og:description" content="My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around trying to find the best christmas lights. Inevitably, their are a few houses with lights that blink with the music, something I&rsquo;ve always been fascinating with.
Two years ago I embarked on a mission to build my own Christmas Tree Light Show.">
<meta property="og:image" content="/img/headShot2.jpg" />
<meta property="og:url" content="/post/deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Uncertainty...Minimized" />
  <meta name="twitter:title" content="Deep Autoencoder Neural Networks for Maximal Christmas Decoration …" />
  <meta name="twitter:description" content="My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around …">
  <meta name="twitter:image" content="/img/headShot2.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@Michael24909206" />
  <meta name="twitter:creator" content="@Michael24909206" />
  <link href='/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="/img/headShot2.jpg" />
  <meta name="twitter:image" content="/img/headShot2.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@Michael24909206" />
  <meta name="twitter:creator" content="@Michael24909206" />
  <meta property="og:url" content="/post/deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Uncertainty...Minimized" />

  <meta name="generator" content="Hugo 0.51" />
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Uncertainty...Minimized">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="/css/highlight.min.css" /><link rel="stylesheet" href="/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">




  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Uncertainty...Minimized</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Samples</a>
              <div class="navlinks-children">
                
                  <a href="/post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="/post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="/post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Uncertainty...Minimized" href="/">
            <img class="avatar-img" src="/img/headShot2.jpg" alt="Uncertainty...Minimized" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Deep Autoencoder Neural Networks for Maximal Christmas Decoration Enjoyment</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on November 21, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;7&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1286&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Michael C Johnson
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<p>My wife loves decorations. From Valentines Day to Easter to Thanksgiving, our house is adorned with interesting festive items. Her favorite season by far is Christmas. Every December we drive around trying to find the best christmas lights. Inevitably, their are a few houses with lights that blink with the music, something I&rsquo;ve always been fascinating with.<br />
Two years ago I embarked on a mission to build my own Christmas Tree Light Show. Roughly this could be acomplished by figuring out what frequencies are playing at a given time, and blinking different lights for a given frequency. Specically this is what I had in mind:
1. Break music up into even sized chunks
2. Convert each chunk into frequency components using <a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform">FFT</a><br />
3. Bucketize frequencies into the number of light channels
4. Activate a light channel when the decibles reached a certain threshold:</p>

<p><img src="/img/LightShowPipeline.jpg" alt="Light Show Pipeline" /></p>

<p>A brief Google investigation revealed I had been (thankfully) beaten to the chase. The open source <a href="http://lightshowpi.org/">lightshowpi</a> project already had a full pipeline, took like 10 minutes to set up, and already had the FFT parralellized on the Raspberry Pi GPU (so you can apply it to streaming music!). Here is a video of our lightshow the first year (christmas tree only):</p>

<p><!--html_preserve-->
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/aAiQ7VSyrno" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
<!--/html_preserve--></p>

<p>What I&rsquo;ve found over the past few years is that while the light show is certainly entertaining (After every song, every year, my kids have a deep expression of joy and clap and congratulate me on my show) I&rsquo;ve been interested in ways to capture more of the structure of the sound in the blinking lights. The light blinking can be sporadic (especially during very fast parts of the song), and vocals are not always captured very well accross octave range&rsquo;s.</p>

<h2 id="enter-deep-autoencoder-neural-networks">Enter: Deep Autoencoder Neural Networks</h2>

<p>Autoencoders are deeply intuitive networks that have a simple premise: reconstruct an input from an output, and in the mean time learn a compressed representation of the data. This is accomplished by squezing the network in the middle, forcing the network to compress x inputs into y intermediate outputs, where x&gt;&gt;y. <a href="https://blog.keras.io/building-autoencoders-in-keras.html">Here</a> is a nice blog post from the Keras blog that goes into some detail on the mnist dataset.</p>

<p><img src="/img/Autoencoder.jpg" alt="Generic AutoEncoder" /></p>

<p>So what exactly are we going to squeeze? Once you&rsquo;ve processed the signal through the FFT, you can make a spectrogram (check out <a href="https://www.youtube.com/watch?v=_FatxGN3vAM">this</a> super psyched youtube video)&hellip; Here time is on the x-axis, frequency is on the y, and the color represents the amplitude for that time/frequency. I&rsquo;d really watch the video mentioned above, but if you could sing a pure <a href="http://pages.mtu.edu/~suits/notefreqs.html">A4 note</a> you&rsquo;d have a solid (in this case red) line at 440Hz. The song we&rsquo;ll study for the rest of the post is &ldquo;<a href="https://www.youtube.com/watch?v=6P9xxJ4V7no">A Mad Russian&rsquo;s Christmas</a>&rdquo; by The Trans Siberian Orchestra, check out the spectrogram:<br />
<img src="/img/madRussianOrig.jpg" alt="A Mad Russian's Christmas" /></p>

<p>You can tell quite a bit about what is going on in the song. The intro starts slow with several repeating sections, quieting down and building up to the fastest section (around 70s). This builds up, faster and louder until it breaks into another rythmic section. From here you can see a few more fast/repeating sections, and a general quieting at the end. I encourage you to look at the spectrogram while you listen to the song, see if you can pick out the different sections. But don&rsquo;t go crazy, there is plenty more fun to be had below!</p>

<p>Since the ultimate goal is to light up different christmas lights at different rythms in the song, what we need to do is to learn a compressed representation of the audio input <em>at each time step</em>. The spectrogram works perfectly for this. There are 513 frequency &lsquo;features&rsquo; at each timestep, so the goal of our autoencoder will be to build an 8-channel representation of each time step (The same number of light channels we have. Note that this is essentially a dimensionality reduction technique, and the standard set of algorithms could be applied here (PCA and Tsne are my favorite, perhaps we&rsquo;ll do another post on those). Something like this:</p>

<p><img src="/img/AutoencoderSpectrogram.jpg" alt="Autoencoder For Spectrogram" /></p>

<p>We&rsquo;ll train &ldquo;A Mad Russian&rsquo;s Christmas&rdquo; and test on &ldquo;Christmas Serajevo&rdquo;. First, lets get some setup out of the way:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">spectrogramUtils</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1">#(Check Bitbucket link for this file. Or use pyplot.specgram....)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">MaxPool1D</span><span class="p">,</span> <span class="n">UpSampling1D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dropout</span></code></pre></div><div class="highlight"><pre class="chroma">## C:\Users\mj514\ANACON~1\lib\site-packages\h5py\__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
##   from ._conv import register_converters as _register_converters
## Using TensorFlow backend.</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="kn">from</span> <span class="nn">keract</span> <span class="kn">import</span> <span class="n">get_activations</span></code></pre></div>
<p>Keract is a nice package that allows you to get the intermediate activations from any Keras-based network. Notice I import both Dense and 1D Convolution layers here, we&rsquo;ll use the latter down below.
Now, create extract the spectrograms out of the the data. <a href="https://bitbucket.org/mj514316/christmasautoencoder/src/master/MakeSpectrogram.ipynb">This notebook</a> shows how to convert from .mp3 to .wav, using ffmpeg. I&rsquo;m not as familiar with powershell as I&rsquo;d like to be, so I just used python to loop through the files. The plotstft function (from spectrogramUtils) breaks our song up into frequency components, and returns a .npy array with 513 features and some number of time step features.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">madIms</span> <span class="o">=</span> <span class="n">plotstft</span><span class="p">(</span><span class="s1">&#39;C:/Users/mj514/Documents/dataSci/christmasAutoencoder/maddrussian.wav&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="2018-11-21-deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">christmasSerajevoIms</span> <span class="o">=</span> <span class="n">plotstft</span><span class="p">(</span><span class="s1">&#39;C:/Users/mj514/Documents/dataSci/christmasAutoencoder/christmasSerajevo.wav&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="2018-11-21-deep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;Class: {madIms.__class__}, shape: {madIms.shape}&#34;</span><span class="p">)</span> <span class="c1"># I recently fell in love with fstrings!!!</span></code></pre></div><div class="highlight"><pre class="chroma">## Class: &lt;class &#39;numpy.ndarray&#39;&gt;, shape: (24330, 513)</pre></div>
<p>Need to scale the inputs. I use the train to set the scale, then apply the scale to the test. This isn&rsquo;t strictly necessary (could set min max based on all of the songs in my library) but I wanted to see how well it could support online use&hellip; in other words you don&rsquo;t know what the rest of the song is going to look like. Also, since our final softmax layer will only output between 0 and 1, that is good range to scale to.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">madIms</span><span class="p">)</span> 
<span class="n">x_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">christmasSerajevoIms</span><span class="p">)</span></code></pre></div>
<p>Next, let&rsquo;s set up our autoencoder. Notice thise one is pretty simple, I found that the final softmax stage was enough to capture most of the complexity. You can get slightly better if you do the stepdown and up(commented out), but considering this will run on a raspberry pi and it doesn&rsquo;t get much better, it&rsquo;s reasonable to skip.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">denseAutoencoder</span><span class="p">(</span><span class="n">internalActivation</span> <span class="o">=</span> <span class="s1">&#39;tanh&#39;</span><span class="p">):</span>
    <span class="n">input_img</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">513</span><span class="p">,))</span>
    <span class="n">input_dropped</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">input_img</span><span class="p">)</span>
    <span class="c1"># encoded = Dense(128, activation=internalActivation, name = &#39;encode_128&#39;)(input_img)</span>
    <span class="c1"># encoded = Dense(64, activation=internalActivation, name = &#39;encode_64&#39;)(encoded)</span>
    <span class="c1"># encoded = Dense(32, activation=internalActivation, name = &#39;encode_32&#39;)(encoded)</span>
    <span class="c1"># encoded = Dense(16, activation=internalActivation, name = &#39;encode_16&#39;)(encoded)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">internalActivation</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;encode_8&#39;</span><span class="p">)(</span><span class="n">input_dropped</span><span class="p">)</span>
    <span class="c1"># # encoded = Dense(4, activation=&#39;relu&#39;)(encoded)</span>
    <span class="c1"># encoded = Dense(2, activation=&#39;relu&#39;)(encoded)</span>
    <span class="c1"># encoded = Dense(1, activation=&#39;relu&#39;)(encoded)</span>
    <span class="c1">#decoded = Dense(16, activation=internalActivation, name = &#39;decode_16&#39;)(encoded)</span>
    <span class="c1"># decoded = Dense(32, activation=internalActivation, name = &#39;decode_32&#39;)(decoded)</span>
    <span class="c1"># decoded = Dense(64, activation=internalActivation, name = &#39;decode_64&#39;)(decoded)</span>
    <span class="c1"># decoded = Dense(128, activation=internalActivation, name = &#39;decode_128&#39;)(decoded)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">513</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span><span class="p">)(</span><span class="n">encoded</span><span class="p">)</span>

    <span class="n">autoencoderDense</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_img</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>
    <span class="n">autoencoderDense</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">autoencoderDense</span>
    
<span class="n">autoencoderDense</span> <span class="o">=</span> <span class="n">denseAutoencoder</span><span class="p">()</span>
<span class="n">autoencoderDense</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span>
                <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1">#important</span>
                <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">x_test</span><span class="p">))</span></code></pre></div>
<p>Couple of things to note, I played with all of the internal activations and tanh was by far the best. I suspect tanh was better than relu in this case because of the inherent non linear nature of sound. Just goes to show that you should craft your architecture to fit the problem at hand. Also, the network is very sensative to overfitting. This could be partially resolved by just adding more songs, and for the production version of this I&rsquo;ll train on every song in my library. Imagine the different structure that would need to be captured for songs that are mainly vocals vs these which are highly instrumental.</p>


        
          <div class="blog-tags">
            
              <a href="//tags/deep-learning/">Deep Learning</a>&nbsp;
            
              <a href="//tags/raspberry-pi/">Raspberry Pi</a>&nbsp;
            
              <a href="//tags/python/">python</a>&nbsp;
            
              <a href="//tags/keras/">Keras</a>&nbsp;
            
              <a href="//tags/tensorflow/">tensorflow</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f&amp;text=Deep%20Autoencoder%20Neural%20Networks%20for%20Maximal%20Christmas%20Decoration%20Enjoyment&amp;via=Michael24909206" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//plus.google.com/share?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f" target="_blank" title="Share on Google Plus">
          <i class="fab fa-google-plus"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f&amp;title=Deep%20Autoencoder%20Neural%20Networks%20for%20Maximal%20Christmas%20Decoration%20Enjoyment" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f&amp;title=Deep%20Autoencoder%20Neural%20Networks%20for%20Maximal%20Christmas%20Decoration%20Enjoyment" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f&amp;title=Deep%20Autoencoder%20Neural%20Networks%20for%20Maximal%20Christmas%20Decoration%20Enjoyment" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=%2fpost%2fdeep-autoencoder-neural-networks-for-maximal-christmas-decoration-enjoyment%2f&amp;description=Deep%20Autoencoder%20Neural%20Networks%20for%20Maximal%20Christmas%20Decoration%20Enjoyment" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  
              </div>
            </section>
        

        
          
          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="/post/2017-03-20-photoswipe-gallery-sample/" data-toggle="tooltip" data-placement="top" title="Photoswipe Gallery Sample">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:mj514316@domain.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/mj514316" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://bitbucket.org/mj514316" title="Bitbucket">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-bitbucket fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/Michael24909206" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/michael-johnson-5105a053" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Michael C Johnson
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2018
          

          
            &nbsp;&bull;&nbsp;
            <a href="/">Uncertainty...Minimized</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.51</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>








  </body>
</html>

